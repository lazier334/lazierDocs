var LazierDocs={caches:{baseLinkElement:null,},runScript:true,container:document.body,loadSingleCss(cssUrl){if(cssUrl==undefined)cssUrl=new URLSearchParams(location.search).get('theme')||'ban';if(cssUrl=='ban')return;if(!this.caches.baseLinkElement){this.caches.baseLinkElement=document.createElement('link');this.caches.baseLinkElement.rel='stylesheet';document.head.appendChild(this.caches.baseLinkElement)}this.caches.baseLinkElement.href=cssUrl},parseMarkdown(mdText){return window.markdownit({html:true,linkify:true,typographer:true}).render(mdText)},htmlOnload(){this.hookWinddowOnloadBefore();if(location.pathname.endsWith('.md')){this.loadMarkdown();this.hookLoadedMD()}if(location.pathname.endsWith('/index.html')){this.hookCacheMdList()}this.hookWinddowOnloadAfter()},loadMarkdown(mdText){let mdBody=mdText||window.mdText||'';if(mdBody!=''){mdBody=new TextDecoder().decode(new Uint8Array(mdBody.split(',').map(Number)));this.hookMDBody();this.loadSingleCss();this.container.innerHTML=this.parseMarkdown(mdBody);if(this.runScript)this.executeScripts(this.container)}},executeScripts(container){const scripts=Array.from(container.querySelectorAll('script'));scripts.forEach(oldScript=>{const newScript=document.createElement('script');Array.from(oldScript.attributes).forEach(attr=>{newScript.setAttribute(attr.name,attr.value)});newScript.textContent=oldScript.textContent;oldScript.parentNode.replaceChild(newScript,oldScript)})},hookCacheMdList(){},hookLoadedMD(){},hookMDBody(){},hookWinddowOnloadBefore(){},hookWinddowOnloadAfter(){},};(()=>{registerServiceWorker();window.onload=()=>LazierDocs.htmlOnload()})();function registerServiceWorker(){if('serviceWorker'in navigator){if(navigator.serviceWorker.controller){return console.log('Service Worker 已处于控制状态')}fetch('sw.js',{method:'HEAD'}).then(response=>{if(response.ok){return navigator.serviceWorker.register('sw.js').then(registration=>console.log('Service Worker 注册成功:',registration)).catch(error=>console.log('Service Worker 注册失败:',error))}}).catch(()=>console.log('sw.js 不存在，跳过注册'))}}function clearCache(){fetch('clearSWCache').then(response=>response.json()).then(data=>{alert(data.message);if(data.success){window.location.reload()}}).catch(error=>alert('清理缓存失败: '+error.message))}